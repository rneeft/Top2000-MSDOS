REM This build script runs on the build agent
REM The build agent has version Visual Basic for MS-DOS 1.0
REM installed and is mounted on Q: (since the script
REM is automatically mounted on C:

REM step 1 is Build the project
REM step 2 create the files for a 1.44 MB disk
REM step 3 create the files for standalone ZIP
REM step 4 create the file for standalone ZIP which include DOSBOX

CD SRC
MKDIR BIN
CD BIN

REM Step 1: Build project 
Q:\VBDOS\BC C:\SRC\TOP2000\TOP2000.BAS/E/O/T/C:512;
Q:\VBDOS\BC C:\SRC\TOP2000\ABOUT.FRM/O/T/C:512;
Q:\VBDOS\BC C:\SRC\TOP2000\DETAILS.FRM/O/T/C:512;
Q:\VBDOS\BC C:\SRC\TOP2000\DETAILSX.BAS/O/T/C:512;
Q:\VBDOS\BC C:\SRC\TOP2000\EDITIONS.FRM/O/T/C:512;
Q:\VBDOS\BC C:\SRC\TOP2000\EDITIONX.BAS/O/T/C:512;
Q:\VBDOS\BC C:\SRC\TOP2000\JUMP2POS.FRM/O/T/C:512;
Q:\VBDOS\BC C:\SRC\TOP2000\JUMP2POX.BAS/O/T/C:512;
Q:\VBDOS\BC C:\SRC\TOP2000\MAIN.FRM/O/T/C:512;
Q:\VBDOS\BC C:\SRC\TOP2000\MAINX.BAS/O/T/C:512;

REM Compile EXE
Q:\VBDOS\LINK @C:\LINK.TMP;

REM Step 2: Create 1.44 MB disk folder
C:\SRC\LIB\COMPRESS.EXE -r C:\SRC\BIN\TOP2000.EXE C:\SRC\BIN\DISK
C:\SRC\LIB\COMPRESS.EXE -r C:\SRC\TOP2000\TOP2000.ICO C:\SRC\BIN\DISK
C:\SRC\LIB\COMPRESS.EXE -r C:\SRC\TOOLS\TOP2000.DAT C:\SRC\BIN\DISK
COPY C:\SRC\TOOLS\LEESMIJ.txt C:\SRC\BIN\DISK\Leesmij.txt
COPY C:\SRC\LIB\EXPAND.EXE C:\SRC\BIN\DISK\EXPAND.EXE
COPY C:\SRC\TOOLS\INSTALL.BA_ C:\SRC\BIN\DISK\INSTALL.BAT

REM Step 3: create file for standalone output
MKDIR C:\SRC\BIN\ZIP
COPY C:\SRC\BIN\TOP2000.EXE C:\SRC\BIN\ZIP\TOP2000.EXE
COPY C:\SRC\TOP2000\TOP2000.ICO C:\SRC\BIN\ZIP\TOP2000.ICO
COPY C:\SRC\TOOLS\TOP2000.DAT C:\SRC\BIN\ZIP\TOP2000.DAT

REM Step 4: Create DOSBox output
COPY C:\SRC\BIN\TOP2000.EXE C:\SRC\BIN\DOSBOX\TOP2000.EXE
COPY C:\SRC\TOP2000\TOP2000.ICO C:\SRC\BIN\DOSBOX\TOP2000.ICO
COPY C:\SRC\TOOLS\TOP2000.DAT C:\SRC\BIN\DOSBOX\TOP2000.DAT